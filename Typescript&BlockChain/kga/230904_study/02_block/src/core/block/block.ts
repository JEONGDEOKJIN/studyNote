
import {SHA256} from 'crypto-js';
import merkle from 'merkle';

import BlockHeader from './blockHeaders';
    /* [BlockHeader í´ë˜ìŠ¤ ê±°ì¹˜ë©´ ë‚˜ì˜¤ëŠ” ê²ƒ]  
        BlockHeader ì˜ ì¸ìŠ¤í„´ìŠ¤ = {
            version : "BlockHeader ì˜ getVersion ë©”ì†Œë“œ ì‹¤í–‰í•´ì„œ ë‚˜ì˜´", 
            height : "ì´ì „ ë¸”ë¡ì˜ height + 1"   // âœ…ì´ì „ ë¸”ë¡ì€ BlockHeader í´ë˜ìŠ¤ë¥¼ í˜¸ì¶œí•  ë•Œ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜´
            timestamp : "BlockHeader ì˜ getTimestamp ë©”ì†Œë“œ ì‹¤í–‰í•´ì„œ ë‚˜ì˜´",
            previousHash : "ì´ì „ë¸”ë¡ì˜ hash"    // âœ…ì´ì „ ë¸”ë¡ì€ BlockHeader í´ë˜ìŠ¤ë¥¼ í˜¸ì¶œí•  ë•Œ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜´
        }
    */

import { IBlock } from '@core/interface/block.interface';
    // "@core/*" : ["src/core/*"], ì´ê±°ì— ì˜í•´, ë³„ì¹­ìœ¼ë¡œ ì§€ì •ëœ ê²ƒ ì„. 
    // IBlock ì€ ë¸”ë¡ì˜ ê°ì²´ êµ¬ì¡°ë¥¼ ì •ì˜í•œ ë†ˆì„ 

import { Failable } from '@core/interface/failable.interface';

import CryptoModule from '@core/crypto/crypto.module';  // í•´ì‹œê°’(16ì§„ìˆ˜) ë¥¼ 2ì§„ìˆ˜ë¡œ ë³€í™˜ í•˜ëŠ” ê¸°ëŠ¥


// block ì˜ í˜•íƒœë¥¼ í´ë˜ìŠ¤ë¡œ ì •ì˜ 
    export class Block extends BlockHeader implements IBlock {
        
        // ë¸”ë¡ Header ì˜ ë‚´ìš©ì´ ì¶”ê°€ ë¨. (extends BlockHeader ì— ì˜í•´ , interface ëŠ” iBlockHeader)
            // ê²°êµ­, â­â­â­Block í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë  ë•Œ, BlockHeader ê¹Œì§€ í•¨ê»˜ ë¬»ì–´ì„œâ­â­â­ ë‚˜ì˜´     
                /* BlockHeader ì˜ ì¸ìŠ¤í„´ìŠ¤ = {
                            version : "BlockHeader ì˜ getVersion ë©”ì†Œë“œ ì‹¤í–‰í•´ì„œ ë‚˜ì˜´", 
                            height : "ì´ì „ ë¸”ë¡ì˜ height + 1"   // âœ…ì´ì „ ë¸”ë¡ì€ BlockHeader í´ë˜ìŠ¤ë¥¼ í˜¸ì¶œí•  ë•Œ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜´
                            timestamp : "BlockHeader ì˜ getTimestamp ë©”ì†Œë“œ ì‹¤í–‰í•´ì„œ ë‚˜ì˜´",
                            previousHash : "ì´ì „ë¸”ë¡ì˜ hash"    // âœ…ì´ì „ ë¸”ë¡ì€ BlockHeader í´ë˜ìŠ¤ë¥¼ í˜¸ì¶œí•  ë•Œ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜´
                    } 
                */
            // ê·¸ëŸ¬ë©´, Block ì—ì„œëŠ”, BlockHeader ë¡œ ìƒì†ë°›ì€ ê²ƒ ì œì™¸í•˜ê³  ë‚˜ì˜¬ ê²ƒ! 
        
        // Block'Header' ì´ì™¸ì—ì˜ 'ë³¸ë¬¸' êµ¬ì„± ğŸ‘‡ | IBlock ì¸í„°í˜ì´ìŠ¤ë¡œ ë¶€í„° ë‚˜ì˜´! ê·¸ë˜ì„œ ìë™ì™„ì„± ë¨| 
            hash: string;
            merkleRoot: string;
            nonce: number;
            difficulty: number;
            data: string[];

        // ìƒì„±ì í•¨ìˆ˜ | Block í´ë˜ìŠ¤ê°€ í˜¸ì¶œë˜ë©´ ì‹¤í–‰
            constructor(_previousBlock : Block , _data : string[] ){

                // 'ì´ì „ block(_previousBlock)' ì´ 'extends ë°›ì€ BlockHeaderì˜ ìƒì„±ì í•¨ìˆ˜' ì— ì „ë‹¬
                super(_previousBlock)
                    /* [ì´ ì½”ë“œì˜ í¬ì¸íŠ¸] â­â­â­â­â­â­ | ì½”ë“œë¥¼ ë‹¨ìˆœí•˜ë©´ì„œ, ê¹”ë”í•˜ê²Œ ì“°ëŠ”ë° ìˆì–´ ì¤‘ìš”í•œ ì½”ë“œë¼ê³  ìƒê°í•¨ â­â­â­ 
                            'ì´ì „ ë¸”ë¡ë°ì´í„°' ì€ header ë¡œ ì´ë™ -> 'ìƒì†' ë˜ì–´ì„œ ë“¤ì–´ì˜¨ë‹¤. 
                            í•˜ë‚˜ì˜ Block ì˜ êµ¬ì„±ìš”ì†ŒëŠ” 1) header ì™€ 2) ë³¸ë¬¸ìœ¼ë¡œ êµ¬ì„± 
                            í•˜ë‚˜ì˜ Block ì„ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ í‘œí˜„í•˜ì§€ ì•Šê³ , 
                                1) ì¤‘ìš”í•œ ë³¸ë¬¸ì€ ê·¸ëŒ€ë¡œ ë‘ê³  2) header(ë©”íƒ€ë°ì´í„°) ëŠ” ìƒì†ë°›ì•˜ë‹¤ëŠ” ê²ƒ
                        [ì´ í¬ì¸íŠ¸ë¥¼ ì¼ë°˜í™” í•´ë³´ê¸°] â­â­â­â­â­ 
                            ì´ê²ƒì„ ì¼ë°˜í™” í•˜ë©´, A ì˜ êµ¬ì„±ìš”ì†Œ B, C ê°€ ìˆìœ¼ë©´, ëª¨ë‘, í•˜ë‚˜ì˜ íŒŒì¼ì—ì„œ ì‘ì„±í•˜ì§€ ì•ŠìŒ. 
                            í•˜ìœ„ ìš”ì†Œ ì¤‘ ì¤‘ìš”í•œ ìš”ì†Œë¥¼ ì•ìœ¼ë¡œ ë¹¼ê³ , ë‚˜ë¨¸ì§€ë¥¼ 'ìƒì†' ë°›ì•„ì„œ, í‘œí˜„í•¨. 
                            ê²°êµ­, í•˜ë‚˜ë¡œ í‘œí˜„ë˜ëŠ” ê±´ ë™ì¼í•¨.  
                    */
            
                // Block í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ ë¨¸í´ë£¨íŠ¸
                this.merkleRoot = Block.getMerkleRoot(_data)
                   // [staticì‚¬ìš©ì‹œ ì‹¤ìµ] _data ê°€ í•œë²ˆ ë“¤ì–´ì˜¤ë©´, â­'í•œë°©ì—!â­ ë¨¸í´ë£¨íŠ¸ê¹Œì§€ êµ¬í•´ì§!
                    // ë”°ë¡œ Block.getMerkleRoot ë³„ë„ë¡œ í•´ì¤„ í•„ìš” ì—†ìŒ.  

                    
                // Block í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ í•´ì‹œê°’
                    // Block ì˜ êµ¬ì„±ìš”ì†Œ = 1) ë³¸ë¬¸ 2) header 
                    // ìƒˆë¡œìš´ Block ìœ¼ë¡œ ì™”ìœ¼ë‹ˆ, ëª¨ë“  êµ¬ì„± ìš”ì†Œë¥¼ í•©í•´ì„œ, ë‹¤ì‹œ í•´ì‹œê°’ì„ êµ¬í•œë‹¤. 
                this.hash = Block.createBlockHash(this)
                    /* [ê¶ê¸ˆì¦] ì´ this.hash ë¼ëŠ”ê²Œ ì–´ë–¤ ë§¥ë½ì—ì„œ ì‹¤í–‰ë˜ëŠ”ê±°ì•¼? â“â“â“
                                ì¦‰, ì–´ë–¤ ê°ì²´? ìƒˆë¡œìš´ data ê°€ ì¤€ë¹„ë˜ëŠ” ì‹œì ? 
                                1) Block ì´ë¼ëŠ” í´ë˜ìŠ¤ê°€ í˜¸ì¶œë˜ë©´ -> block ì¸ìŠ¤í„´ìŠ¤ê°€ ë§Œë“¤ì–´ì§„ë‹¤. 
                                2) ì´ block ì¸ìŠ¤í„´ìŠ¤ëŠ” a) header ì •ë³´ b) ì´ block ì´ ë§Œë“¤ì–´ ì§ˆ ë•Œ ë“¤ì–´ì˜¨, ë³¸ë¬¸ ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤. 
                                3) ì´ì œ ì´ ì •ë³´ë¥¼ í•©ì³ì„œ 'í•´ì‹œí™”' ë¥¼ í•œë‹¤. 
                                4) ê·¸ëŸ¬ë©´, ì´ ë¸”ë¡ì—ì„œ, ì´ ì •ë³´ê°€, ì´ íƒ€ì´ë°ì— ë“¤ì–´ì™”ë‹¤ëŠ” ê²ƒì„ 'ë°•ì œ' í•  ìˆ˜ ìˆë‹¤!
                                5) â­â­â­ ì¦‰, 'í•´ì‹œí™”' ë˜ì–´ì•¼ -> 'ë°•ì œ' ë  ìˆ˜ ìˆê³  -> 'ë°ì´í„° ë¬´ê²°ì„±' ì´ ìƒê¸´ë‹¤. 
                                6) â­â­â­ 'ë¬´ì—‡' ì´ í•´ì‹œí™” ë˜ëŠ”ê°€? a) header ì •ë³´(ì´ì „ hash ë“±) + b) ì§€ê¸ˆ ë“¤ì–´ì˜¨ data! 
                    */
            
                // ë¸”ë¡ ì±„êµ´ì€ ë’¤ì— ì¶”ê°€ 
                    this.nonce = 0;
                        /* [nonce ë€?]  
                            - number used once : 'íŠ¹ì • ì¡°ê±´'ì„ ë§Œì¡±í•˜ê²Œ í•˜ëŠ” 'ìœ ì¼í•œ ê°’' ì„. 

                            - 'ì²˜ìŒë¶€í„°, 0ì´ ì—°ì†í•´ì„œ 5ë²ˆ ë‚˜ì˜¤ëŠ” í•´ì‹œê°’' ì„ ë§Œë“¤ì–´ë¼, ì™€ ê°™ì´ 
                            'íŠ¹ì • ë¬¸ì œ'ë¥¼ í‘¸ëŠ”ë°, âœ…'ëª‡ ë²ˆ' ê±¸ë ¸ë‚˜, ë¥¼ ì˜ë¯¸í•˜ëŠ”ê²Œ nonce.
                        */

                        /* [ê·¸ëŸ¬ë©´, nonce ëŠ” ì±„êµ´ì„ ë‹¤ í•˜ê³ , ì¶”ê°€ë˜ëŠ” ê°’ ì•„ë‹Œê°€?]

                        */
            
                // ì§€ê¸ˆì€ ê³ ì •ê°’. ë¸”ë¡ ì±„êµ´ ë˜ê³ , ë‚˜ì¤‘ì— ì¶”ê°€ë  ê²ƒ! 
                this.difficulty = 3
                    /* [í•´ì„]
                        'difficulty = 3' = 'í•´ì‹œê°’ ë§¨ ì•ì—ì„œ ë¶€í„°, 0ì´, 3ë²ˆ ì—°ì†' í•´ì„œ ë‚˜ì™€ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ 
                    */

            
                // ì´ë²ˆ ë¸”ë¡ì—ì„œ ë“¤ì–´ì˜¨ data 
                this.data = _data
            }

            // ë¸”ë¡ ì¶”ê°€ í•¨ìˆ˜ 
            static generateBlock( _previousBlock : Block, _data : string[]) : Block {
                
                // (ì§€ê¸ˆ ë§Œë“¤ê³  ìˆëŠ”) Block í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰ì‹œì¼œì„œ -> ë¸”ë¡ì„ ë§Œë“ ë‹¤. 
                const generateBlock = new Block(_previousBlock , _data)
                    /* generateBlock êµ¬ì¡° = Block í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤(Block ì˜ ì¸ìŠ¤í„´ìŠ¤) = {
                            // BlockHeader ë¥¼ ìƒì†ë°›ì•„ì„œ ìƒê¸°ëŠ” ë¶€ë¶„    
                                version : 
                                height : 
                                timestamp : 
                                previousHash : 
                            // Block ë³¸ë¬¸
                                merkleRoot: string;
                                nonce: number;
                                difficulty: number;
                                data: string[];
                        }
                    */


                // ë§ˆì´ë‹ì„ í†µí•´, ë¸”ë¡ ìƒì„± ê¶Œí•œì„ ë°›ì€ ë¸”ë¡ì„ ë§Œë“ ë‹¤. 
                const newBlock = Block.findBlock(generateBlock);
                    // ì´ ì½”ë“œì˜ ê¸°ëŠ¥ì„ ëª¨ë¥´ê² ì–´ ğŸ˜¥ğŸ˜¥

                return newBlock;
            }
                /* [generateBlock ê³¼ findBlock ì˜ ê´€ê³„] â­â­â­â­â­
                    generateBlock ì€ 
                        1) Block ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ê³  
                        2) findBlock ì—ì„œ ë¬¸ì œë¥¼ í‘¼ block ì—, nonce ê°’ì„ ì—…ë°ì´íŠ¸ í•´ì„œ
                        3) newBlock ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•œë‹¤.  
                */
        
            // ë¸”ë¡ ì¶”ê°€ 
            // ë§ˆì´ë‹(ì±„êµ´) | ë¸”ë¡ì„ ì±„êµ´í•˜ëŠ” ë™ì‘
            static findBlock(generateBlock : Block){
                let hash : string;

                let nonce : number = 0;
                    // ì²˜ìŒì— nonce ë¥¼ 0 ìœ¼ë¡œ ì¤€ë‹¤. 
                    // ë§ˆì´ë‹ì€ ë‚œì´ë„ì— ë”°ë¼ì„œ, ë‹µì„ ì°¾ëŠ”ë°, ë¸”ë¡ ì±„êµ´ í•  ë•Œ, ì—°ì‚°ì„ ëª‡ ë²ˆ í–ˆëŠ”ì§€, ë¥¼ ì´ê³³ì— ë‹´ëŠ”ë‹¤. 
                    
                while(true){
                    generateBlock.nonce = nonce;    
                        // ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜¨ generateBlock ì˜ nonce ì— nonce ì„¤ì •ê°’ ë„£ê¸° 

                    // nonce ê°’ 1 ì¦ê°€
                    nonce++;
                        // [í•´ì„] â­â­â­ 
                            // nonce ê°’ ì¦ê°€ -> block ì˜ ë³¸ë¬¸ ë³€ê²½ -> hash ë³€ê²½ë¨ â­â­â­
                            // ì´ê²ƒ ë•Œë¬¸ì—, í•´ë‹¹ ë‚œì´ë„ì— ë§ëŠ” hash ê°’ì„ ë•Œ ê¹Œì§€ ë°˜ë³µí•˜ëŠ”ê²Œ ì˜ë¯¸ê°€ ìˆìŒ. 

                    // block ì¸ìŠ¤í„´ìŠ¤(header + ë³¸ë¬¸) ë¥¼ createBlockHash ì— ë„£ê³  í•´ì‹œí™” ì‹œí‚¤ê¸°
                    hash = Block.createBlockHash(generateBlock)

                    // ë‚˜ì˜¨ í•´ì‹œê°’ì—ì„œ 'ì²« 0ì´ ì—°ì†ë˜ëŠ” ê°œìˆ˜ì™€ difficultyì´ ë§ëŠ”ì§€' í™•ì¸í•˜ê¸° 
                        // í•´ì‹œê°’(16ì§„ìˆ˜) ì´ì§„ìˆ˜ë¡œ ë§Œë“¤ê¸°
                        const binary : string = CryptoModule.hashToBinary(hash)
                        console.log("binary" , binary)

                        // 'í•´ì‹œê°’ì˜ ì²˜ìŒ ì—°ì†ë˜ëŠ” 0ì˜ ê°œìˆ˜' ê°€ 'difficulty' ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ì²´í¬ 
                        const result : boolean = binary.startsWith("0".repeat(generateBlock.difficulty))
                        console.log("result" , result)
                            /* [ë¶ˆí™•ì‹¤ í–ˆë˜ ë¶€ë¶„]
                                "í˜„ì¬ difficulty ê°’ì„ ì–´ë–¤ ê°ì²´ê°€ ê°–ê³  ìˆëŠ”ê°€!" ì—ì„œ, constructor í•¨ìˆ˜ì—ì„œ difficultyê°€ ì •ì˜ë˜ì—ˆìŒ. 
                            */

                    // ë§ì·„ìœ¼ë©´ -> ë¸”ë¡ ì±„êµ´ ê¶Œí•œì„ ì–»ìŒ -> ì±„êµ´ëœ ë¸”ë¡ì„ ë°˜í™˜! (ì¡°ê±´ì— ì¶©ì¡±í•´ì„œ ë‚˜ì˜¨ ê°’ì„ ë°˜í™˜!)
                    if(result){
                        // ì—°ì‚°ì„ í†µí•´ ì™„ì„±ëœ hash ë¥¼ ì¸ìŠ¤í„´ìŠ¤ì— ë„£ìŒ
                        generateBlock.hash = hash
                            /* ì´ì „ê¹Œì§€, generateBlock ì˜ hash ì†ì„±ì€ ë¹„ì–´ìˆì—ˆìŒ. 
                                'generateBlock ì˜ hash ì†ì„±' ì— ë°©ê¸ˆ ê³„ì‚°í•œ hash ê°’ì„ ë„£ì—ˆìŒ. -> 'ì™„ì„±ëœ ë¸”ë¡' ì´ ëœë‹¤. 

                                ë§Œì•½, result == false ë¼ë©´, í•´ë‹¹ blockì—ëŠ” hash ê°’ì´ ë¹„ì–´ìˆë‹¤. 
                            */

                        // ì™„ì„±ëœ ë¸”ë¡ì„ ë‚´ë³´ë‚´ê¸° 
                        return generateBlock
                            /* [í•´ì„] 
                                nonceê°’ì€ ì²œì°¨ë§Œë³„ ì´ê² ì§€ë§Œ, ê²°êµ­, return ë˜ëŠ”ê²Œ ìˆê¸´ í•  ê²ƒ! â­â­â­  
                                ì˜ˆë¥¼ ë“¤ì–´, í•œë°©ì— ë§ì·„ìœ¼ë©´, nonce ëŠ” 0. 
                                11ë²ˆì§¸ì— ë§ì·„ìœ¼ë©´, nonce ëŠ” 10

                                ê·¸ëŸ¬ë©´, ì´ nonce ë¥¼ ì–´ë””ì— ì¨? 

                                ê·¸ëŸ¬ë©´, ì´ì œ, 'nonce 11 ì„ í¬í•¨í•œ header + ë³¸ë¬¸' ë¸”ë¡ì´ ìˆì–´~ ë¼ê³  âœ…'ë„¤íŠ¸ì›Œí¬ì— ì „íŒŒ' í•œë‹¤. 
                            */
                    }
                    /* [ê¶ê¸ˆí•œ ì ]
                        - ë§ì¶”ì§€ ëª» í•˜ë©´, ë‹¤ìŒ ë¸”ë¡ì´ ê³„ì† ë‚˜íƒ€ë‚˜ë‚˜?
                            - ë§¤ê°œë³€ìˆ˜ë¡œ ë‹¤ë¥¸ê²Œ ì˜¤ëŠ”ê²Œ ì•„ë‹ˆë¼, í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì˜ nonce ê°’ì´ ë³€í™”í•˜ë©´ì„œ -> ë‹¤ë¥¸ hash ê°’ì„ í…ŒìŠ¤íŠ¸ í•´ë³´ê²Œ ëœë‹¤.
                            - input ì´ ì¡°ê¸ˆë§Œ ë°”ë€Œì–´ë„, hash ê°’ì´ í¬ê²Œ ë³€í™”í•˜ë¯€ë¡œ, ì œì‹œëœ difficulty ë¥¼ ë§ì¶œ ë•Œ ê¹Œì§€, ì‹œë„í•  ìˆ˜ ìˆë‹¤.  

                        - ë¸”ë¡ ì±„êµ´ ê¶Œí•œì„ ì–»ëŠ”ë‹¤ëŠ”ê²Œ, êµ¬ì²´ì ìœ¼ë¡œ ë­ì§€? 
                            - ë§ì¶˜ë‹¤ë©´ -> 'ì „íŒŒ' í•˜ê²Œ ëœë‹¤. 
                            - ë§Œì•½, ê°€ì¥ ë¹¨ë¦¬ ë§ì·„ë‹¤ë©´ -> ê·¸ì— ë”°ë¼ì„œ 'ë³´ìƒ' ì„ ë°›ëŠ”ë‹¤. 
                            
                        - ì±„êµ´ëœ ë¸”ë¡ì„ ë°˜í™˜í•œë‹¤ê³ ? (ì¡°ê±´ì— ì¶©ì¡±í•´ì„œ ë‚˜ì˜¨ ê°’ì„ ë°˜í™˜ í•œë‹¤êµ¬?)
                            - ì´ ë§ì€, difficulty ë¥¼ ë§ì¶˜ hash ê°’ì„, generateBlock ì˜ í•´ì‹œì— ë„£ëŠ”ë‹¤ëŠ” ê±¸ë¡œ ì´í•´í•¨. 

                        - ë³´ìƒì´ ì–´ë–»ê²Œ ì§„í–‰ë˜ëŠ”ë°? â­â­â­â­â­
                            - 'ë§ˆì´ë‹' í–ˆìœ¼ë©´ -> 'ì „íŒŒ'(ë„¤íŠ¸ì›Œí¬ì— ì•Œë¦°ë‹¤.) í•˜ê³  -> 'longest ì—¬ë¶€ í™•ì¸' -> longest ë©´, ë³´ìƒì„ ë°›ìŒ!, ë” ì§§ìœ¼ë©´ ë°›ì§€ ëª» í•¨. 
                            - POW ë°©ì‹
                            - ì´ ë¬¸ì œë¥¼ 'ë§ˆì´ë‹' ì´ ì•„ë‹ˆë¼, 'ë²„ì „ì„ ì–´ë””ì— ë§ì¶°ì„œ ì—…ë°ì´íŠ¸ í•  ê²ƒ ì¸ê°€.' ì˜ ë¬¸ì œë¡œ ë³´ê¸°ë„ í•¨. 
                            - ì²˜ìŒì—” cpu ì„ ì‚¬ìš©í–ˆë‹¤ê°€, ë‚˜ì¤‘ì—” ê³„ì‚°ì´ ë›°ì–´ë‚œ gpu ë¥¼ ì‚¬ìš©
                    */                        
                }
            }

            // ë¸”ë¡ì˜ í•´ì‹œë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ | 'header' ì™€ 'ìƒˆë¡œìš´ data' ë¥¼ ë”í•´ì„œ 'í˜„ì¬ ë¸”ë¡ì˜ í•´ì‹œ' ë¥¼ êµ¬í•˜ëŠ” ê±´ê°€? ğŸ“› 
            static createBlockHash(_block : Block) : string {

                // 'Block í´ë˜ìŠ¤ì„ í˜¸ì¶œí•´ì„œ ê°€ì ¸ì˜¨ _block ì¸ìŠ¤í„´ìŠ¤' ì—ì„œ ëª¨ë“  ì •ë³´ë¥¼ ë¹¼ë‚´ê¸° 
                const {
                        // BlockHeader ìƒì†ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
                        version, height, timestamp, previousHash , 
                        // Block ë³¸ë¬¸
                        merkleRoot , nonce , difficulty , data
                    } = _block

                // ëª¨ë“  ì •ë³´ë¥¼, ë‹¤ í•©ì³ì„œ, SHA256 ìœ¼ë¡œ, í•´ì‹œí™” ì‹œí‚¤ê¸°
                const value : string = `${version} ${height} ${timestamp} ${previousHash} ${merkleRoot} ${nonce} ${difficulty} ${data} `
                
                return SHA256(value).toString();
            }
                /* â­â­ _block ì´ ë­˜ ì˜ë¯¸í•˜ëŠ”ì§€ë¥¼ ì•„ëŠ”ê²Œ ë„ˆë¬´ ë„ˆë¬´ ì¤‘ìš”í•¨ â­â­â­ 
                    _block = this ë¡œ ë„£ì–´ì§€ê²Œ ë  ê²ƒ ì„ = Block í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ = ì§€ê¸ˆ ë§Œë“¤ê³  ìˆëŠ” í´ë˜ìŠ¤ì¸ Block ì˜ ì¸ìŠ¤í„´ìŠ¤ 
                    = block ì˜ ì¸ìŠ¤í„´ìŠ¤ = {
                        // BlockHeader ë¥¼ ìƒì†ë°›ì•„ì„œ ìƒê¸°ëŠ” ë¶€ë¶„    
                            version : 
                            height : 
                            timestamp : 
                            previousHash : 
                        // Block ë³¸ë¬¸
                            merkleRoot: string;
                            nonce: number;
                            difficulty: number;
                            data: string[];
                    }
                */

            // ë¨¸í´ë£¨íŠ¸ ë°˜í™˜ í•¨ìˆ˜
            // í•´ë‹¹ data ê°€ ë“¤ì–´ì˜¤ë©´ -> í•´ë‹¹ data ì˜ ìµœì¢… ë¶€ëª¨ ë…¸ë“œì˜ í•´ì‹œê°’(ë¨¸í´ë£¨íŠ¸)ì„ êµ¬í•¨ 
            static getMerkleRoot<T>(_data : T[]) : string {
                const merkleTree = merkle("sha256").sync(_data)
                return merkleTree.root()
            }
            /* [(_data : T[]) í•´ì„]
                - _data ë§¤ê°œë³€ìˆ˜ê°€ 'ë°°ì—´' ì´ê¸´ í•¨. 
                - ê·¸ëŸ°ë°, 'ë°°ì—´ ìš”ì†Œê°€ ì–´ë–¤ê²Œ ë“¤ì–´ê°ˆì§€.' ëŠ” ì•„ì§ ë¯¸ì • 
                - T ê°€ ì •í•´ì§€ë©´ 'ë°°ì—´ ìš”ì†Œë„ í™•ì •' ë¨. 
            */


    }