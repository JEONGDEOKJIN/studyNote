// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;
import './IERC20.sol';

// implements ì²˜ëŸ¼ js class ì—ì„œ ì¸í„°í˜ì´ìŠ¤ ìƒì†ì„ í•œ ê²ƒ ì²˜ëŸ¼, ì—¬ê¸°ì—ì„œë„ ìƒì†! ì„ í•¨ 
// ì†”ë¦¬ë””í‹°ëŠ” 'is êµ¬ë¬¸' ì„ ì‚¬ìš©í•´ì„œ ìƒì†

contract ERC20 is IERC20{
    // ERC20 í† í°ì˜ ê·œì•½
    
    // í† í°ì˜ ì´ë¦„ì„ ë‹´ì„ ìƒíƒœë³€ìˆ˜, í’€ ë„¤ì„ | ì´ë”ë¦¬ì›€ ì´ê² ì§€ |  
    string public name;

    // í† í°ì˜ ì‹¬ë³¼ | í† í°ì˜ ë‹¨ìœ„ë¥¼ í‘œí˜„ ã„´| ETH ë“± 
    string public symbol;

    // í† í°ì˜ ì†Œìˆ˜ì  ìë¦¬ | ì†Œìˆ˜ì ì„ ì–¼ë§ˆë‚˜ í• ì§€ | 
        // ê¸°ë³¸ ì†Œìˆ˜ì  ìë¦¬ëŠ” 18 ë‹¨ìœ„ | ì´ë”ë¦¬ì›€ ë‹¨ìœ„ì™€ ë™ì¼ 
        uint8 public decimals = 18;     // í† í°ì˜ ë‹¨ìœ„ë¥¼ 10ì˜ 18ìŠ¹ í•´ì•¼ í•˜ë‹ˆê¹Œ ìƒíƒœ ë³€ìˆ˜ë¡œ ë¹¼ë†“ëŠ” ê²ƒ

    // í† í°ì˜ ì´ ë°œí–‰ëŸ‰ | ì´ë¯¸ ì„ ì–¸ì´ ë˜ì–´ ìˆëŠ” í•¨ìˆ˜(interface ğŸ˜¥ğŸ˜¥ í•¨ìˆ˜ëŠ” virtual ë¡œ ë˜ì–´ ìˆìŒ ğŸ˜¥ğŸ˜¥)
    // ê¸°ë³¸ ì„ ì–¸í•˜ë©´, virtual í•¨ìˆ˜ì„ 
    // ìƒì† ë°›ì€ í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ì •ì˜í•´ì„œ ì‚¬ìš© (ë®ì–´ì“°ê¸°)
    uint public override totalSupply;

    // ì»¨íŠ¸ë™íŠ¸ ë°°í¬ì | í˜„ì¬ ë²„ì „ì—” ìƒì† ë°›ì•„ì„œ ì‚¬ìš©ì¤‘ | í˜„ì¬ ERC20 ì— ì‘ì„±í•  í•„ìš”ê°€ ì—†ì–´ ì¡ŒìŒ. ì™œëƒë©´ ì—…ë°ì´íŠ¸ í•˜ë©´ì„œ ë¹¼ë²„ë ¸ìŒ
    address private owner;


    // ìƒì„±ì í•¨ìˆ˜ | ì»¨íŠ¸ë™íŠ¸ ë°°í¬ìê°€ ì‹¤í–‰ì„ í•  í•¨ìˆ˜
    constructor(string memory _name , string memory _symbol, uint256 _amount ) {
        // ì–´ë–¤ ì´ë¦„ì˜ í† í°ì„ ë°œí–‰í•˜ê³  ìˆê³ , ì–´ë–¤ ë‹¨ìœ„ì˜ ì‹¬ë³¼ì„ ì‚¬ìš©í• ì§€ 
        // ì²˜ìŒ ì´ ë°œí–‰ëŸ‰ì„ ì–¼ë§ˆë‚˜ ì„¤ì •í• ì§€, ì— ëŒ€í•œ ë‚´ìš©ì„ constructor ì— ì ëŠ”ë‹¤. 

        // SOONTOKEN 
        owner = msg.sender;     // ì»¨íŠ¸ë™íŠ¸ ë°°í¬ìë¥¼ onwer ì— ë„£ì–´ì¤€ë‹¤. 
        name = _name;       // SOONTOKEN ì´ë©´ ì´ê²Œ _name ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.
        symbol = _symbol;    // STK ë¼ëŠ” ë‹¨ìœ„

        // í† í° ë°œí–‰í•  ë•Œ, ì‚¬ìš©í• , ë©”ì„œë“œ ì‘ì„± 
            // _amount * (10 ** uint256(decimals))
            // ë°œí–‰í•  ë‹¨ìœ„ë¥¼ ë„£ëŠ”ë‹¤. 

        // ìµœì´ˆë¡œ ìˆëŠ” ê°œìˆ˜â“â“â“
        mint (_amount * (10 ** uint256(decimals)));

    }
        // ERC20 ì´ ê°œìˆ˜, ì‹¬ë³¼ ë“± 
    // string memory : 'ë©”ëª¨ë¦¬ ì˜ì—­ì—ì„œ ì‚¬ìš©ë˜ê³  ğŸ‘‰ í•´ì œ ëœë‹¤!' ë¼ëŠ” ì˜ë¯¸ë¥¼ ê°–ëŠ” êµ¬ë¬¸
        // uint ëŠ” ì•ˆ ì“°ëŠ”ë°, ì´ê±´ ì“°ëŠ” ì´ìœ ëŠ”, uint ëŠ” uint256 ì´ë ‡ê²Œ, ì‚¬ìš©í•˜ëŠ” ë°”ì´íŠ¸ ì–‘ì´ ì •í•´ì ¸ ìˆìŒ. 
        // ê·¸ëŸ°ë°, ë¬¸ìì—´ì€ ê°€ë³€ì ì„. ì–¼ë§ˆë‚˜ ì“¸ì§€ ëª¨ë¦„ ğŸ‘‰ ì´ëŸ´ ë•ŒëŠ” memory ë¥¼ ë‹¤ ë¶™ì¸ë‹¤! â­â­â­ 

    // â­â­ ë°œí–‰í•˜ë©´, ì–´ë””ì— ë‹´ê¸°ëƒ -> mapping ê°ì²´ì— ë‹´ê¹€ 

    // balance : í† í°ì„, ëˆ„ê°€, ì–¼ë§Œí¼, ê°€ì§€ê³  ìˆëŠ”ì§€ì˜ ë‚´ìš©ì„ ë‹´ì„ ê°ì²´ 
    mapping(address => uint) public balances; 
        // ì–´ë–¤ key :  address, value : unit ë¥¼ ê°–ê³  ìˆì„ ê²ƒ ì¸ê°€ 
        /* 
            balance ë¼ëŠ” ë³€ìˆ˜ ëª… ì•ˆì— ê°ì²´ê°€ ë“¤ì–´ê° | ëˆ„êµ°ê°€ê°€ ê°–ê³  ìˆëŠ”ì§€ë¥¼ ê°–ê³  ìˆìŒ | 
            balance = {
                0x123123123123123123123(ì§€ê°‘ì£¼ì†Œ 40ìë¦¬) : 100ê°œ, 
                0x127777123123123123123(ì§€ê°‘ì£¼ì†Œ 40ìë¦¬) : 100ê°œ, 
                0x127777123166666777777(ì§€ê°‘ì£¼ì†Œ 40ìë¦¬) : 200ê°œ, 
            }
                - 0x123123123123123123123 ì´ ì‚¬ëŒì„ ì¡°íšŒí•˜ë©´ -> 100ê°œ ê°–ê³  ìˆë‹¤ëŠ”ê²Œ ë‚˜ì˜´ 
                - UTXO ë‘ ë¹„ìŠ· â­â­â­â­â­
        */

        // 'í† í°ì˜ ê¶Œí•œ'ì„ 'ìœ„ì„' ë°›ì€ ë‚´ìš©ì´ ë“¤ì–´ê°€ ìˆëŠ” ê°ì²´
        mapping(address => mapping(address => uint)) public override allowance;
        /*
            balance = {
                0x123123123123123123123(ì§€ê°‘ì£¼ì†Œ 40ìë¦¬) : {
                    0x1231231231231231211777773 : 50ê°œ (ì´ ì‚¬ëŒì´ 100ê°œ ì¤‘ 50ê°œ ë°›ìŒ)  
                },

                0x127777123123123123123(ì§€ê°‘ì£¼ì†Œ 40ìë¦¬) : {
                    0x1231231231231231211777773 : 70ê°œ (ì´ ì‚¬ëŒì´ 100ê°œ ì¤‘ 70ê°œ ë°›ìŒ)
                }, 
                0x127777123166666777777(ì§€ê°‘ì£¼ì†Œ 40ìë¦¬) : {
                    0x1231231231231231211777773 : 75ê°œ 
                }, 
            }
        */

        // ì”ì•¡ì„ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜ 
        function balanceOf(address account) external view override returns(uint) {
            return balances[account];   // ì§€ê°‘ì£¼ì†Œë¥¼ ë„£ìœ¼ë©´, balance ê°€ ëª‡ê°œ ì¸ì§€ë¥¼ ë°˜í™˜ 

        } 
        
        // ë‹¤ë¥¸ ì§€ê°‘ìœ¼ë¡œ ì”ì•¡ì„ ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜ | a ê°€ b ì—ê²Œ, í† í°, ì„ ë³´ëƒˆì„ ë•Œ, ì‘ì„±í•˜ëŠ” í•¨ìˆ˜ 
        function transfer(address to, uint amount) external override returns(bool){
            // ëˆ„ê°€ ì „ë‹¬í•˜ëŠ”ì§€ | ì „ë‹¬í•˜ëŠ” ì‚¬ëŒì˜ ì”ì•¡ì´ ê°ì†Œí•´ì•¼ í•œë‹¤ | ì²«ë²ˆì§¸! 
            balances[msg.sender] -= amount;
                // ìê¸°ê°€ ì „ë‹¬í•œ ë§Œí¼ ë¹ ì§€ê²Œ ë  ê²ƒ | balances ì•ˆì— ìˆëŠ” ê²Œ ë¹ ì§ˆ ê²ƒ 

            // 'ì „ë‹¬ë°›ëŠ” ì‚¬ëŒì˜ ì”ì•¡' ì´ ì¦ê°€!
            balances[to] += amount;
                // ì „ë‹¬í•œ ë§Œí¼! ì¦ê°€ë˜ì–´ì•¼ í•¨ 

            // transfer ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¨ ë¡œê·¸ë¥¼ íŠ¸ëœì­ì…˜ì—ì„œ í™•ì¸! 
                // ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¬ ë•ŒëŠ” emit ë¥¼ ì‚¬ìš©í•œë‹¤ â­â­â­ | socket ì—ì„œë„ ì´ê±¸ ì”€ 
            emit Transfer(msg.sender , to, amount);
                // to : ë‚´ê°€ ë³´ë‚¸ ì‚¬ëŒ 
                // value : ì–¼ë§ˆë¥¼ ë³´ëƒˆëŠ”ì§€

            // ì„±ê³µì€ true ê°€ ë°˜í™˜ë˜ëŠ” í•¨ìˆ˜
            // ì‹¤íŒ¨ëŠ” false 
            return true;
        }

        // í† í°ì˜ ì†Œìœ ê¶Œì„ ìœ„ì„í•˜ëŠ” í•¨ìˆ˜ | ê·¸ ì‚¬ëŒì´ ì†Œìœ ê¶Œì„ ê°€ì§ˆ ìˆ˜ ìˆê²Œ
        function approve(address sender , uint amount) external override returns (bool) {
            // ì†Œìœ ê¶Œì„ ì¶”ê°€ 
            allowance[msg.sender][sender] = amount;
                // ì§€ê¸ˆ ìœ„ì„ ì „ë‹¬í•˜ëŠ” ì£¼ì†Œ :[msg.sender][sender]
            
            // ì´ì œ ì´ë²¤íŠ¸ ë°œìƒ ì‹œì¼œì„œ í™•ì¸ 
            emit Approval(msg.sender , sender, amount);

            // ì„±ê³µì€ true | ì‹¤íŒ¨ëŠ” false ê°€ ë°˜í™˜
            return true;
        }

        // ê¶Œí•œì„ ê°€ì§€ê³  ìˆëŠ” ì œ3ìê°€, í† í°ì„ ë³´ë‚¼ ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ 
        function transferFrom(address sender,  address to,  uint amount) external override returns(bool) {
                // ê¶Œí•œì„ ê°–ê³  ìˆëŠ” ì‚¬ëŒ(sender) ì´, ëˆ„êµ¬ ì—ê²Œ (to), ì–¼ë§ˆ(amount) ë¥¼
            
            // ì´ ì‚¬ëŒì´ ê¶Œí•œì„ ê°–ê³  ìˆëŠ”ì§€, í† ê·¼ì˜ ëŸ‰ì„ ê²€ì‚¬ë¥¼ í•˜ê³  
            require(allowance[sender][msg.sender] >= amount);

            allowance[sender][msg.sender] -= amount;
            balances[sender] -= amount;     // ê¶Œí•œì„ ë°›ì€ ì‚¬ëŒì˜ ê²ƒì„ ë¹¼ê³ 
        
            balances[to] += amount;     // í† í° ì „ë‹¬ë°›ì€ ì‚¬ëŒì€, ê·¸ ë§Œí¼ì„ ë°›ëŠ”ë‹¤.
            return true;
        }
        




        // í† í°ì„ ë°œí–‰ í•˜ëŠ” í•¨ìˆ˜ : ì´ ê°œìˆ˜ì— ì¶”ê°€ ë˜ë©´ì„œ, ì†Œìœ ê¶Œì„ ì»¨íŠ¸ë™íŠ¸ ë°°í¬í•œ ì‚¬ëŒì´ ê°–ê³  ìˆë‹¤ê°€ -> ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ í† í°ì„ ì „ì†¡í•´ì¤Œ 
            // internal : ì»¨íŠ¸ë™íŠ¸ ë‚´ë¶€ì—ì„œë§Œ ì‹¤í–‰ì‹œí‚¬ í•¨ìˆ˜
        function mint(uint amount) internal {
            balances[msg.sender] += amount;     // ì‹¤í–‰ì‹œí‚¨ ì‚¬ëŒì´ ê°œìˆ˜ë¥¼ ê°–ëŠ”ë‹¤.
            totalSupply += amount;      // ë°œí–‰ëœ ê°œìˆ˜ê°€ ì ì  ëŠ˜ì–´ë‚  ê²ƒ
            
            // ë¯¼íŒ…ì„ í•˜ë©´, í† íƒˆ ê°œìˆ˜ê°€ ìŒ“ì´ê³ , ì–¼ë§Œí¼ ëëŠ”ì§€ëŠ”, amount ì— ë„£ìœ¼ë©´ ë¨. 
        }

        // í† í°ì„ ì†Œê° ì‹œí‚¤ëŠ” í•¨ìˆ˜ 
            // í† í°ì„ ë„ˆë¬´ ë§ì´ ë°œí–‰í•˜ë©´, ê°€ì¹˜ê°€ ë–¨ì–´ì§€ê¸° ë•Œë¬¸ì—, ì†Œê° ì‹œí‚¨ë‹¤. 
        function burn(uint amount) external {
            balances[msg.sender] -= amount;
            totalSupply -= amount;

        }


}