// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

import "./IERC20.sol";

contract ERC20 is IERC20 {

    // í† í°ì˜ ì´ë¦„ 
    string public name;

    // í† í° ë‹¨ìœ„ ì§€ì • | ì‹¬í´ | ex) ETH
    string public symbol;

    // í† í°ì˜ ì†Œìˆ˜ì  ìë¦¬ | ê¸°ë³¸ 18ìë¦¬ë¡œ êµ¬ì„± | #ğŸ“› ì˜ ì´í•´ê°€ ì•ˆ ë¨ 
    uint public decimals = 18;

    // í˜„ì¬ í† í°ì˜ ì´ ë°œí–‰ëŸ‰ | ìƒì† ë°›ì€ê±¸ ë®ì–´ì¨ì„œ, ë°œí–‰ëŸ‰ ì§€ì •í•˜ê¸° 
    uint public override totalSupply;

    address private owner;

    // ë§¤í•‘ ê°ì²´ | íŠ¹ì • ê³„ì • | í•´ë‹¹ ê³„ì •ì—, ëª‡ ê°œì˜ í† í°ì´ ìˆëŠ”ê°€. 
    mapping(address => uint) public balances;
        /* [í•´ì„] balances ëŠ” 'ê°ì²´' ì˜ ì¼ì¢…
            - address : ëŠ” ê°ì²´ì—ì„œ key ì™€ ë¹„ìŠ· 
            - uintìœ¼ë¡œ ë“¤ì–´ì˜¨ ê°’ì„, addressì˜ value ë¡œ ë§¤í•‘(mapping) í•˜ê² ë‹¤, ë¼ëŠ” ì˜ë¯¸. 
            - public : ì™¸ë¶€ì—ì„œ ê°’ì„ ì½ì„ ìˆ˜ ìˆìŒ. | ì™¸ë¶€ì—ì„œ ê°’ ìˆ˜ì •í•˜ë ¤ë©´, solidity ê±°ì³ì•¼ í•¨ | ë‚´ë¶€ì—ì„œ ê°’ ì½ê³ , ìˆ˜ì • ê°€ëŠ¥ |  
                    : ì—¬ê¸°ì—ì„œ, ì™¸ë¶€, ë‚´ë¶€ëŠ” í´ë˜ìŠ¤ì—ì„œ, í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´ ë‚˜ì˜¤ê²Œ ë˜ëŠ” í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ, ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë©”ì†Œë“œì¸ì§€ ì—¬ë¶€ë¥¼ ì˜ë¯¸í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·.
            - ì˜ˆì‹œ í˜•íƒœ 
                {
                    "key ë¡œ ì£¼ì†Œê°€ ì˜´" " 100000(100000ê°œ ë¼ëŠ” ì˜ë¯¸) 
                }
        */

    // ìœ„ì„ ë°›ì„ ë•Œ | #ğŸ“› ì´í•´ ì•ˆ ë¼
    mapping( address => mapping( address => uint ) ) public override allowance;
        /* ë§¤í•‘ ê°ì²´ ì•ˆì—, ë§¤í•‘ ê°ì²´ê°€ ìˆìŒ. 
            {
                "Aì£¼ì†Œ" : {
                    "Bì£¼ì†Œ" : 500 (ìœ„ì„ ë°›ì€ ì–‘ | 1000ê°œ ì¤‘ 500ê°œ ìœ„ì„)
                }
            }
        */

    // CA ì— ì´ë”ë¥¼ ë°›ìœ¼ë©´ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ë©”ì†Œë“œ 
    receive() external payable {

        // ì†Œìœ ê¶Œì„ ì¤„ í† í°ì˜ ì–‘ | ë°›ì€ ì´ë” ë¹„ìœ¨ë¡œ | ì´ë” 1ê°œë¡œ, 200ê°œ í¬ì¼“ëª¬ í† í°ì„ ì‚¬ê°„ë‹¤.  
        uint amount = msg.value * 200;
            // [í•´ì„] msg.value : ì‚¬ìš©ìê°€ ë‚¸(ì§€ë¶ˆí•œ) ì´ë”ë¦¬ì›€ì˜ ì–‘ 

        // ëˆ„êµ°ê°€ í¬ì¼“ëª¬ ì½”ì¸ì„ ì‚° ìƒí™©ì—ì„œ, owner ê°€ ê°–ê³  ìˆëŠ” ì½”ì¸ì´, 200ê°œ ë³´ë‹¤ ë§ì€ì§€ í™•ì¸
        require(balances[owner] >= amount );
            /* - balances[owner] í•´ì„
                : balances ë§¤í•‘ ê°ì²´ì—ì„œ, owner(ì§€ê°‘ ì£¼ì†Œë¥¼ ì˜ë¯¸í•˜ëŠ” owner) ëŠ” key ë¡œ ë“¤ì–´ê° -> ê·¸ëŸ¬ë©´, í•´ë‹¹ owner ì£¼ì†Œê°€ ê°–ê³  ìˆëŠ” í¬ì¼“ëª¬ í† í° ê°œìˆ˜ê°€ ë‚˜ì˜¤ê²Œ ë  ê²ƒ  

                - ë§Œì•½, balances[owner] ì´ ê°–ê³  ìˆëŠ” ì½”ì¸ì´, 200ê°œ ë³´ë‹¤ ë¶€ì¡±í•˜ë©´, í¬ì¼“ëª¬ ì½”ì¸ì„ ëª» ì‚¬ëŠ”ê±° ê² ë„¤!? ğŸ‘‰ ê·¸ëŸ¬í•¨ ğŸ‘‰ ì´ ìˆœê°„, ê²½ì œí•™ì  ê°œë…ì´ ë“¤ì–´ê° â­â­â­â­â­â­
            */

        // 'ì£¼ì¸ì´ ê°–ê³  ìˆëŠ” ì½”ì¸ì˜ ê°œìˆ˜' ì—ì„œ 'ì‹ ì²­ë°›ì€ ì½”ì¸ ê°œìˆ˜' ë§Œí¼ ëº€ë‹¤.
        balances[owner] -= amount;

        // 'ë³´ë‚¸ ì£¼ì†Œ' ì—ì„œ, 'ì‹ ì²­í•œ ì½”ì¸' ë§Œí¼, ë”í•´ì„œ ë°›ëŠ”ë‹¤. 
        balances[msg.sender] -= amount;

        // mint ì¡°ê±´ | ì•„ì§ ì´í•´ë¥¼ ë‹¤ ëª» í•¨ #ğŸ“›
        if(msg.sender == owner) {
            // ë³´ë‚¸ ê²ƒ ë§Œí¼, mint ì‹¤í–‰ | ë¶€ì¡±í•˜ë©´, ë˜, ì´ì œ, í† í°ì„ ë°œí–‰
            mint(amount);
        }
        /* ì§€ë‚œë²ˆ íŒŒì¼ì— ë‹¬ë¦° ì£¼ì„ì„ ğŸ‘‡ğŸ‘‡ 
            ë§Œì•½, í† í°ì„, ë‹¤ ì†Œìœ ê¶Œì„ ë„˜ê²¨ì„œ, ë°°í¬ìê°€ ë“¤ê³  ìˆëŠ” í† í°ì´ ì—†ë‹¤. 
            ë§Œì•½, ë°°í¬ìê°€, ì´ë”ë¥¼, ë³´ëƒˆìœ¼ë©´, í† í°ì„ ë” ë°œí–‰í•  ìˆ˜ ìˆê²Œ | ì´ ë°œí–‰ëŸ‰ì´ ëŠ˜ì–´ë‚¨
        */
    }
        /*
            external : ì™¸ë¶€ í˜¸ì¶œë§Œ! ê°€ëŠ¥. ë‚´ë¶€ í˜¸ì¶œì€ ë¶ˆê°€

            - ì´í•´ ë¶€ì¡±í•œ ë¶€ë¶„ ğŸ‘‡ğŸ‘‡ğŸ‘‡ 
            ë°°í¬ìê°€ í† í°ì˜ ë°œí–‰ëŸ‰ì„ ëª¨ë‘ ê´€ë¦¬í•˜ê³ , | ë°°í¬ì ê°œë… ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ ë°œëª© ì¡íˆì§€ ì•Šê²Œ
            ë‹¤ë¥¸ ì´ìš©ìë“¤ì´ í† í°ì„ ì–»ê³  ì‹¶ìœ¼ë©´, 
            ì»¨íŠ¸ë™íŠ¸ ë°°í¬ìê°€, ì •í•œ, ë¹„ìœ¨, ì— ë”°ë¼, í† í°ì„ ê°€ì ¸ê°ˆ ìˆ˜ ìˆê²Œ 
            í† í° ë°œí–‰ìê°€ ì´ë”ë¦¬ì›€ì„ ë°›ê³ , ê°–ê³  ìˆëŠ” ê±¸ ë„˜ê¹€, 
        */

    // ì»¨íŠ¸ë™íŠ¸ ìƒì„±ì | ì´ê±¸ ì‹¤í–‰í•˜ë©´, í¬ì¼“ëª¬ í† í°ì´ ìƒì„±ë¨ 
    constructor( string memory _name , string memory _symbol, uint256 _amount ) {

        owner = msg.sender;
        name = _name;
        symbol = _symbol;

        // ë¯¼íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³ , ì†Œìˆ˜ì  ë‹¨ìœ„ì— ë§ì¶°ì„œ ëŠì–´ì¤€ë‹¤? | ê·¸ëŸ¬ë©´, ì†Œìˆ˜ì  ë‹¨ìœ„ê°€ 18ê°œ ë¶™ì„ ê²ƒ
        mint(_amount * (10 ** uint256(decimals)) );

    }
        /* [í•´ì„]
        - string memory : ìŠ¤íŠ¸ë§ì€ ê°€ë³€ì ì´ê¸° ë•Œë¬¸ì—, memory ë¥¼ ë¶™ì—¬ì•¼ í•¨
        
        - msg.sender | 
            : ì—¬ê¸°ì—ì„œ, sender ë¼ëŠ” ë§ì€, ì´ë¯¸ ì¡´ì¬í•˜ëŠ” CA ì—ê²Œ, ë­”ê°€ë¥¼ ë³´ëƒˆë‹¤. ë¼ëŠ” ì˜ë¯¸? 
            : ì¦‰, ì—¬ê¸°ì—ì„œ msg ëŠ” íŠ¸ëœì­ì…˜ ì…ì¥ì—ì„œ, ë°›ê²Œ ë˜ë©´, ì´ê±° í• ê²Œ~ ë¼ëŠ” ì˜ë¯¸? 
        */

    // í† í° ë°œí–‰ëŸ‰ì„ ì§€ì •í•˜ëŠ” í•¨ìˆ˜ 
    function mint(uint amount) internal {
        // sendë¥¼ í•œ ëˆ„êµ°ê°€ì˜ ê³„ì •ì—, amount ê°€ ë“¤ì–´ê°€ê²Œ ëœë‹¤.
        balances[msg.sender] += amount;

        // ì´ë°œí–‰ëŸ‰ì— ë“¤ì–´ê°€ê²Œ ëœë‹¤. 
        totalSupply += amount;
    }

    // ë‚¨ì€ í† í°ì„ í™•ì¸í•˜ëŠ” í•¨ìˆ˜ 
    function balanceOf( address account) external view override returns(uint) {
        return balances[account];
    }

    // ëˆ„êµ°ê°€ì—ê²Œ, ë‚´ê°€ ê°–ê³  ìˆëŠ” í† í°ì„ ì „ì†¡ í•˜ê¸° 
    function transfer(address to, uint amount) external override returns(bool) {
        // ë§¤í•‘ ê°ì²´ ì•ˆì— ìˆëŠ” ë³¸ì¸ì˜ í† í° ì–‘ì„ ë¹¼ê³ 
        balances[msg.sender] -= amount;

        // to ê³„ì • ì‚¬ëŒì—ê²Œ ë³´ëƒ„ 
        balances[to] += amount;

        return true;
    }

    // ìœ„ì„ í•˜ëŠ” í•¨ìˆ˜ | #ğŸ“› 
    function approve(address spender, uint amount) external override returns(bool) {

        // ìœ„ì„ ë°›ëŠ” ë‚´ìš©ì„ ë°›ëŠ” ê°ì²´
        allowance[msg.sender][spender] = amount;

        return true;
    }

    // ëª¨ë¥´ê² ì–´ #ğŸ“›
    function transferFrom( address spender , address to, uint amount ) external override returns(bool) {
        require(allowance[spender][msg.sender] >= amount);

        allowance[spender][msg.sender] -= amount ;

        balances[spender] -= amount;
        balances[to] += amount;

        return true;
        /*
            sender == A 
            msg.sender == B
            to == C
            A ê°€ B ì—ê²Œ ìœ„ì„í•œ ê²½ìš° 
                {
                    A : {
                        B : 100
                    }
                }

            // 50ê°œ ìœ„ì„í•˜ë©´ ????????//
                {
                    A : {
                        B : 50
                    }
                }

            // 50ê°œ ìœ„ì„í•˜ë©´ ????????
                {
                    A : 950
                    C : 50
                    
                }
        */
    }

    // ì–´ì œê²ƒ ë³´ê³  ì ê¸° 
    function burn (uint amount) external {
        balances[msg.sender] -= amount;
        totalSupply -= amount;
    }


}